<div ng-include="'components/navbar/navbar.html'"></div>

<div class="modal-header" id="group-heading"> 
    <h3 ng-hide="editorEnabledName" class="modal-title">{{currGroup.name}}
        <button class="btn btn-primary btn-xs" ng-click="enableEditorName()">
        	Edit Name <span class="glyphicon glyphicon-pencil"></span>
        </button>
    </h3>
    <div ng-show="editorEnabledName">
        <form name="name" class="form-inline" ng-submit="saveName()" novalidate>
            <input type="text" class="form-control" name="gName" ng-model="newName" ng-show="editorEnabledName" required/>
            <div class="form-group has-error">
          	    <p class="help-block" ng-show="name.gName.$error.required && submitted">
                    Please enter a Group Name.
          	    </p>
            </div>
            <button class="btn btn-primary" type="submit">Save</button>
            <button class="btn btn-danger" ng-click="disableEditor()">Cancel</button>
        </form>
    </div>
</div> 
<div class="modal-body">
    <tabset>
        <tab heading="General"><h3>Group Information</h3>
        <hr>
            <div>Established: {{currGroup.establishedDate | date:'dd/MM/yyyy'}}</div>
            <div>Website: <a href="{{currGroup.websiteURL}}" target="_blank">{{currGroup.websiteURL}}</a></div>
            <div>Facebook: <a href="{{currGroup.facebookURL}}" target="_blank">{{currGroup.facebookURL}}</a></div>
            <div>Social Media: <a href="{{currGroup.socialMediaURL}}" target="_blank">{{currGroup.socialMediaURL}}</a></div>
            <hr>
            <div>Total Members: {{currGroup.members.length}}</div>
            <div>Total Assigned Tasks: {{iTasks.length}}</div>
            <div>Total Completed Tasks: {{cTasks.length}}</div>
            <div>Total Current Projects: {{gProjects.length}}</div>
        </tab>
        <tab heading="Members"><h3>Group Members</h3>

            <button class="btn btn-default" ng-click="usersIsCollapsed = !usersIsCollapsed">Add New Member</button>
            <div collapse="!usersIsCollapsed">
                <div class="well well-lg">
                    <form name="aMember" ng-submit="addMember(showUsers)" novalidate>
                        <div class="form-group">
                            <label>Select a Member to add:</label>
                            <select name="sUsers" class="form-control" ng-model="showUsers" ng-options="user.name as user.name for user in users | orderBy:'name'" required>
                                <option value="" selected>--Select a member--</option>
                            </select>
                        </div>
                        <div class="form-group has-error">
                            <p class="help-block" ng-show="aMember.sUsers.$error.required && userSubmitted">
                                You have not selected a member.
                            </p>
                        </div>
                        <button class="btn btn-primary" type="submit">Add</button>
                    </form>
                </div>
            </div>
            <hr>
            <div><label>Current Members:</label></div>
            <div ng-repeat="member in currGroup.members"> {{member}} 
                <button class="btn btn-danger btn-xs" ng-click="removeMember(member)">Remove Member</button>
            </div>
        </tab>
        <tab heading="Tasks"><h3>Group Tasks</h3>
        <hr>
            <button class="btn btn-default" ng-click="viewIsCollapsed = !viewIsCollapsed">View Assigned Tasks</button>
	        <div collapse="viewIsCollapsed">
	            <div ng-hide="iTaskData">
	      	        <p>This group currently has no assigned tasks</p>
	            </div>
		        <div ng-show="iTaskData" class="well well-lg" ng-repeat="task in iTasks">
		            <div>Project: {{task.show_id}}</div>
		            <div>Description: {{task.description}}</div>
		            <div>Status: {{task.status}}</div>
		            <div>Assigned By: {{task.assignedByUser_id}} on {{task.dateCreated | date:'dd/MM/yyyy'}}</div>
		            <div>Deadline: {{task.deadline}}</div>
		            <button class="btn btn-primary" id="task-button" ng-click="changeStatus(task)">Mark Completed</button>
		            <button class="btn btn-danger" id="task-button" ng-click="deleteTask(task)">Delete Task</button>
		        </div> 
	        </div>
	        <hr>
	        <button class="btn btn-default" ng-click="completeIsCollapsed = !completeIsCollapsed">View Completed Tasks</button>
	        <div collapse="completeIsCollapsed">
	            <div ng-hide="cTaskData">
	          	    <p>This group currently has no completed tasks</p>
	            </div>
		        <div ng-show="cTaskData" class="well well-lg" ng-repeat="task in cTasks">
		            <div>Project: {{task.show_id}}</div>
		            <div>Description: {{task.description}}</div>
		            <div>Status: {{task.status}}</div>
		            <div>Assigned By: {{task.assignedByUser_id}} on {{task.dateCreated | date:'dd/MM/yyyy'}}</div>
		            <div>Deadline: {{task.deadline}}</div>
		        <button class="btn btn-danger" id="task-button" ng-click="deleteTask(task)">Delete Task</button>
		    </div> 
	    </div>
	    <hr>
	    <button class="btn btn-default" ng-click="assignIsCollapsed = !assignIsCollapsed">Create New Task</button>
	        <div collapse="assignIsCollapsed">
		        <div class="well well-lg">
		            <form name="assignTask" ng-submit="createTask(showProject, taskDesc, dt)" novalidate>
		                <div class="form-group">
                            <label>Project:</label>
                            <div ng-hide="projectData">
                                <p>This group has no projects. Task will be assigned to group.</p>
                            </div>
                            <div ng-show="projectData">
                  	            <p>You can assign tasks to a group project by selecting a project below. Do not select a project to assign project to group.</p>
                                <select name="sProject" class="form-control" ng-model="showProject" ng-options="project.showName as project.showName for project in gProjects | orderBy:'name'">
                                    <option value="" selected>--Assign to Group--</option>
                                </select>
                            </div>
                        </div>
     	                <div class="form-group">
		                    <label>Description:</label>
		                    <textarea class="form-control" name="tName" ng-model="taskDesc" placeholder="Task Description" required/>
     		            </div>
                        <div class="form-group has-error">
                            <p class="help-block" ng-show="assignTask.tName.$error.required && taskSubmitted">
                                You must enter a description.
                            </p>
                        </div>
		                <div class="form-group" style="display:inline-block; min-height:290px;">
		      	            <label>Completion Date: </label>
		                    <datepicker name="date" ng-model="dt" min-date="minDate" show-weeks="true" class="well well-sm" required></datepicker>
 				            <pre>Date Selected: <em>{{dt | date:'fullDate' }}</em></pre>
                        </div>
                        <div class="form-group has-error">
                            <p class="help-block" ng-show="assignTask.date.$error.required && taskSubmitted">
                                Please select a Completion Date.
                            </p>
                        </div>
   	                    <div class="form-group">
		                    <button class="btn btn-primary" type="submit">Assign</button>
		                </div>
		            </form>
		        </div> 
	        </div>
	    </tab>
        <tab heading="Send Message"><h3>Send A New Message</h3><hr></tab>
        <tab heading="Send Form"><h3>Send A New Form</h3><hr></tab>
        <tab heading="Projects"><h3>Current Projects</h3>
      	    <hr>
            <div ng-hide="projectData">
                <p>This group has no projects.</p>
            </div>
      	    <div ng-show="projectData" class="well well-lg col-md-4" ng-repeat="project in gProjects">
		        <div>Project Name: {{project.showName}}</div>
		        <div>Status: {{project.showStatus}}</div>
		        <div>Production Date: {{project.prodDate | date:'dd/MM/yyyy'}}</div>
		    </div>
        </tab>
        <tab heading="Production Meeting"><h3>Current Scheduled Meeting(s)</h3>
            <hr>
            <div ng-hide="meetingData">
                <p>This group has no current scheduled meetings</p>
            </div>
            <div ng-show="meetingData" class="well well-lg col-md-4" ng-repeat="meeting in gMeetings">
                <div>Meeting Name: {{meeting.title}}</div>
                <div>Date Created: {{meeting.date | date:'dd/MM/yyyy'}}</div>
                <div>Project: {{meeting.show}}</div>
                <div>Click <a href="/production-meeting/{{currGroup.name}}/{{meeting.title}}" target="_blank">here</a> to view this meeting. </div>
            </div>
        </tab>
    </tabset>
</div>

<div class="col-md-12" ng-include="'components/footer/footer.html'"></div>